<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;500&#038;display=swap" rel="stylesheet" />

    <!-- font family -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Salsa&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/aos@3.0.0-beta.6/dist/aos.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/aos@3.0.0-beta.6/dist/aos.css" rel="stylesheet">

    <script src="js/helper.js "></script>
    <script src="js/jquery-3.6.1.min.js "></script>

    <link rel="stylesheet" href="css/Normalize.css">
    <link rel="stylesheet" href="css/imagehover.min.css">
    <link rel="stylesheet" href="css/imagehover.css">
    <link rel="stylesheet" href="css/all.min.css" />
    <link rel="stylesheet" href="css/framework.css">
    <link rel="stylesheet" href="css/master.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/animate.min.css">
    <link rel="stylesheet" href="css/hover.css">
    <link rel="stylesheet" href="css/home.css">
    <title>Home</title>
    <link rel="icon" type=" image/svg+xml" href="../imgs/logo.svg" />

    <!-- check if checked in or not  -->
    <script>
        (async() => {
            let pageIndex = 1;
            let apiUrl = await GetServerDomain();
            let language;
            if (window.localStorage.getItem("language") == null) {
                language = "en";
            } else {
                language = window.localStorage.getItem("language");
            }


            // check if theuser is loged in or not 
            $.ajax({
                "method": "GET",
                "url": apiUrl + "/api/Users/IsAllowedToHomeTurbo",
                "xhrFields": {
                    "withCredentials": true
                },
                "headers": {
                    "Content-Type": "application/json",
                    "ngrok-skip-browser-warning": "69420",
                    "Accept-Language": language
                },
                "data": {},
                success: function(data, st, xhr) {
                    console.log(data)
                    if (data.nextPage == "homePatient") {
                        window.location.href = "../login.html";
                    } else if (data.nextPage == "homeDentist") {

                    } else if (data.nextPage == "homeAdmin") {
                        window.location.href = "../login.html";
                    }
                },
                error: function(xhr, status, err) {
                    console.log(xhr);
                    window.location.href = "../login.html";
                }
            })
        })();
    </script>


</head>

<body class="home-bg">

    <nav class="navbar navbar-expand-lg    position-sticky fixed-top  " style="background-color: #CBE4DE;">
        <div class="container-fluid ">
            <a class="navbar-brand " href="home.html"><img style="width: 50px; height:auto" src="imgs/logo.svg" alt=""></a><span class="tittle">FreeSmile</span>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon bg-light mt-3"><i class="fa-solid fa-bars "></i></span>
            </button>
            <div class="collapse navbar-collapse " id="navbarNav">
                <ul class="navbar-nav ms-auto d-flex justify-content-between flex-row w-full col-mob">
                    <div class="d-flex justify-content-center align-center ">
                        <li class="nav-item  fs-5 ml-130">
                            <!-- make it margin right instead of left in arabic -->
                            <div class="search p-relative">
                                <span class="search-icon"></span>
                                <input type="search" placeholder="Type a Word" id="search" class="p-10 ">

                            </div>
                        </li>
                    </div>
                    <div class="d-flex col-mob">
                        <li class="nav-item  fs-5 mr-10">
                            <a href="" class="nav-link active en"><span class="c-black fs-25 mr-5" id="language">EN</span><i class="fa-solid fa-globe fs-25 c-black"></i> </a>
                        </li>

                        <li class="nav-item  fs-5 d-none d-lg-block  l-border">
                            <a href="" class="nav-link active en"> </a>
                        </li>

                        <li class="nav-item  fs-5 mr-15 chatpage ">
                            <a href="../chat.html" class="nav-link active en"><img src="imgs/comment.svg" style="max-width:50px; width: 30px;"></a>
                        </li>

                        <li class="nav-item  fs-5 mr-15 hvr-buzz ">
                            <a href="" class="nav-link active en notificationmark "><img src="imgs/bell.svg" style="max-width:50px; width: 30px;"> </a>

                        </li>

                        <li class="nav-item  fs-5 mr-15">
                            <a href="" class="nav-link active en"><img src="imgs/profilepic.svg" style="max-width:50px; width: 30px;"> </a>
                        </li>

                        <li class="nav-item  fs-5 mr-10 logout">
                            <a href="" class="nav-link active en log-out"><i class="fa-solid fa-arrow-right-from-bracket"></i> </a>
                        </li>
                    </div>
                </ul>
            </div>
        </div>
    </nav>


    <div class="container-fluid mt-30">
        <div class="w-full d-flex justify-content-between">

            <div class="home-pages bg-white position-sticky rad-10">
                <div class="chat-header d-flex justify-content-between mb-10 p-15">
                    <div>
                        <span class="fw-bold fs-rem-20">Intro</span>
                    </div>

                </div>

                <ul class="fs-rem-14 d-flex flex-column w-full h-full ">
                    <li>
                        <div class="d-flex justify-content-center align-items-center align-center p-20">
                            <div class=" flex-column case-bg d-flex flex-column p-20 rad-10 text-break">
                                <p class="bio  rad-10 text-break" style=" max-height: 150px;overflow: hidden;">Lorem ipsum dolor sit amet consectetur adipisicing elit. Blanditiis illum ab cum quidem temporibus aliquam suscipit voluptatum dolore iste, in iure numquam ipsam commo </p>
                                <span class="txt-c cur-point hvr-buzz editbio"> <i class="fa-solid fa-pen mr-px-5"></i>   Edit Bio </span>
                            </div>
                        </div>
                    </li>

                    <li>
                        <div class="d-flex justify-content-center align-items-center align-center p-20">
                            <div class=" case-bg d-flex  p-20 rad-10 w-100 text-break justify-content-center align-items-center " style="min-width: 150px;">
                                <p class="addreview  rad-10 text-break d-flex align-center" style="min-height: 100px; max-height: 150px; overflow: hidden;"> Review </p>

                            </div>
                        </div>
                    </li>

                </ul>

            </div>

            <div class="home-content ">

                <div class="w-full p-px-5 addcase rad-10 nav-bg d-flex justify-content-around">
                    <div class="statephoto ml-10 mt-px-5 d-none d-sm-block">
                        <img src="imgs/profilepic.svg" style="max-height: 50px; height: 48px;">
                    </div>
                    <div class="inputstate w-80 ">
                        <input type="text" disabled class="w-full rad-10 bg-white" placeholder="Click anywhere to add case">
                    </div>

                </div>





                <div class="home-posts mt-25">

                </div>
                <div class="loading-div mb-20">
                    <div class="skeleton-loading bg-white rad-10 shadow-lg d-none">
                        <div class="skeleton-loading__content">

                            <div class="skeleton-loading__info">
                                <div class="d-flex align-center mb-30">
                                    <div class="skeleton-loading__image"></div>
                                    <div class="skeleton-loading__name"></div>
                                </div>
                                <div class="skeleton-loading__title"></div>
                                <div class="skeleton-loading__description"></div>
                                <div class="skeleton-loading__text"></div>
                            </div>
                        </div>
                    </div>



                </div>
            </div>

            <div class="home-chats bg-white rad-10">
                <div class="chat-content d-flex flex-column w-100 p-10">
                    <div class="chat-header d-flex justify-content-between mb-10">
                        <div>
                            <span class="fw-bold fs-rem-20">Chats</span>
                        </div>

                    </div>

                    <div class="chat-users mt-20 w-full d-flex flex-column">
                        <ul class=" w-full chat-users-ul">

                        </ul>
                        <div class="progress loadingchats d-none">
                            <div class="progress-bar progress-bar-striped progress-bar-animated bg-secondary" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 100%"></div>
                        </div>

                    </div>
                </div>
            </div>




        </div>

    </div>













    <div class="nav-bg d-none notification-content rad-10 " style="width: 350px; height: 450px; ">
        <p class="fs-25 fw-bold p-10 mb-20 ">Notifications</p>
        <ul class="w-full notification-ul">



        </ul>

    </div>






    <!-- log out modal  -->

    <button type="button" class="btn btn-primary logoutbutton d-none" data-bs-toggle="modal" data-bs-target="#exampleModal100000000000000000000">
                        Launch demo modal
                        </button>

    <!-- Modal -->
    <div class="modal fade" id="exampleModal100000000000000000000" tabindex="-1" aria-labelledby="exampleModal100000000000000000000" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered logoutmodal">
            <div class="modal-content rad-10">
                <div class="modal-header">

                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body d-flex justify-content-center">
                    <p class="fs-20 c-red fw-bold txt-c">Are you sure you want to log out ?</p>
                </div>
                <div class="modal-footer d-flex w-full justify-content-around mb-25">
                    <button type="button" class="btn btn-secondary p-10 hvr-float-shadow" data-bs-dismiss="modal">No</button>
                    <button type="button" class="btn btn-primary bg-danger p-10 hvr-float-shadow" id="log-out">Yes</button>

                </div>
                <div class="d-flex justify-content-center mt-10 mb-20">
                    <span class="txt-c logouterror c-red">Some thing went wrong ,please try again later</span>
                </div>
            </div>
        </div>
    </div>




    <!-- Edit bio modal -->
    <button type="button" class="btn btn-primary d-none biotrrigermodal" data-bs-toggle="modal" data-bs-target="#exampleModal">
  Launch demo modal
</button>

    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Edit Bio</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="discriptioncase w-full mt-30 d-flex justify-content-center">
                        <div class="mb-3 w-90">
                            <label for="exampleFormControlTextarea1" class="form-label fw-bold fs-20"></label>
                            <textarea required placeholder="Enter bio" maxlength="500" class="form-control bioediting" id="exampleFormControlTextarea1" rows="5"></textarea>

                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary cancel-edited-bio" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary save-edited-bio">Save changes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Review -->
    <button type="button" class="btn btn-primary d-none reviewtrrigermodal" data-bs-toggle="modal" data-bs-target="#exampleModal1">
  Launch demo modal
</button>

    <!-- Modal -->
    <div class="modal fade" id="exampleModal1" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel2">Add Review</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="discriptioncase w-full mt-30 d-flex justify-content-center">
                        <div class="mb-3 w-90">
                            <label for="exampleFormControlTextarea2" class="form-label fw-bold fs-20"></label>
                            <textarea required placeholder="Enter review" maxlength="500" class="form-control addrevieww" id="exampleFormControlTextarea2" rows="5"></textarea>

                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary cancel-add-review" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary save-add-review">Save changes</button>
                </div>
            </div>
        </div>
    </div>






    <script src="js/bootstrap.bundle.min.js "></script>
    <script src="js/all.min.js "></script>
    <script src="js/popper.min.js "></script>
    <script src="js/profile.js "></script>




    <script>
        GetUserInfo("Dentists");
        $(".editbio").click(function() {
            $(".biotrrigermodal").trigger("click");
            $(".bioediting").val($(".bio").text())
        })



        $(".addreview").click(function() {
            $(".reviewtrrigermodal").trigger("click");
        })

        $(".save-edited-bio").click(function() {
            let bio = $(".bioediting").val()

            $(".bio").text(bio);
            $(".cancel-edited-bio").trigger("click");
        })

        $(".save-add-review").click(function() {
            let review = $(".addrevieww").val()

            $(".addreview").text(review);
            $(".cancel-add-review").trigger("click");
        })
    </script>

    <!-- log out  -->
    <script>
        $("#log-out").click(function() {
            logOut()
        })
    </script>





    <!-- get chated people  -->
    <script>
        (async() => {
            let apiUrl = await GetServerDomain();
            var firstMassegeId;

            $.ajax({
                "method": "GET",
                "url": `${apiUrl}/api/Common/GetRecentMessages?Page=1&Size=7`,
                "xhrFields": {
                    "withCredentials": true
                },
                "headers": {
                    "Content-Type": "application/json",
                    "ngrok-skip-browser-warning": "69420",
                    "Accept-Language": language
                },
                beforeSend: function() {

                },
                success: function(data, st, xhr) {
                    console.log(data);
                    if (!(data.length == 0)) {
                        for (var i = 0; i < data.length; i++) {
                            let profilesrc;
                            if (data[i].profilePicture == null) {
                                profilesrc = "imgs/profilepic.svg"
                            } else {
                                profilesrc = "data:image/png;base64," + data[i].profilePicture;
                            }
                            $(".chat-users-ul").append(` <a href="chat.html?id=${data[i].userId}">  <li class="cur-point mb-20 p-px-5 d-flex flex-row">
                            
                                <div class = "d-flex ">
                                    <img src=${profilesrc} alt="" style="max-width: 30px; max-height:30px;" class="user-photo mr-px-5 d-none rad-half d-lg-inline">
                                </div>
                                <div class="d-flex flex-column chat-user-text">
                                    <span class="chat-user fw-bold fs-rem-14">${data[i].fullName}</span>
                                  
                                </div>
                              
                            </li>  </a>`)

                        }
                    }
                },
                error: function(xhr, status, err) {

                }
            })



        })();
    </script>



</body>

</html>