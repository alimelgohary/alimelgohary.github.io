<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;500&#038;display=swap" rel="stylesheet" />

    <link rel="stylesheet" href="../css/Normalize.css">
    <link rel="stylesheet" href="../css/imagehover.min.css">
    <link rel="stylesheet" href="../css/imagehover.css">
    <link rel="stylesheet" href="../css/all.min.css" />
    <link rel="stylesheet" href="../css/framework.css">
    <link rel="stylesheet" href="../css/master.css">
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/animate.min.css">
    <link rel="stylesheet" href="../css/hover.css">
    <link rel="stylesheet" href="../css/home.css">
    <title>Home</title>
    <link rel="icon" type=" image/svg+xml" href="../imgs/logo.svg" />


</head>

<body class="home-bg">

    <nav class="navbar navbar-expand-lg    position-sticky fixed-top  " style="background-color: #CBE4DE;">
        <div class="container-fluid ">
            <a class="navbar-brand " href="index.html"><img style="width: 50px; height:auto" src="../imgs/logo.svg" alt=""></a><span class="tittle">FreeSmile</span>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon bg-light mt-3"><i class="fa-solid fa-bars "></i></span>
            </button>
            <div class="collapse navbar-collapse " id="navbarNav">
                <ul class="navbar-nav ms-auto d-flex justify-content-between flex-row w-full col-mob">
                    <div class="d-flex justify-content-center align-center ">
                        <li class="nav-item  fs-5 ml-130">
                            <!-- make it margin right instead of left in arabic -->
                            <div class="search p-relative">
                                <span class="search-icon"></span>
                                <input type="search" placeholder="Type a Word" id="search" class="p-10 ">

                            </div>
                        </li>
                    </div>
                    <div class="d-flex col-mob">
                        <li class="nav-item  fs-5 mr-10">
                            <a href="" class="nav-link active en"><span class="c-black fs-25 mr-5" id="language">EN</span><i class="fa-solid fa-globe fs-25 c-black"></i> </a>
                        </li>

                        <li class="nav-item  fs-5 d-none d-lg-block  l-border">
                            <a href="" class="nav-link active en"> </a>
                        </li>

                        <li class="nav-item  fs-5 mr-15  ">
                            <a href="" class="nav-link active en"><img src="../imgs/comment.svg" style="max-width:50px; width: 30px;"></a>
                        </li>

                        <li class="nav-item  fs-5 mr-15 hvr-buzz ">
                            <a href="" class="nav-link active en notificationmark "><img src="../imgs/bell.svg" style="max-width:50px; width: 30px;"> </a>

                        </li>

                        <li class="nav-item  fs-5 mr-15">
                            <a href="" class="nav-link active en"><img src="../imgs/profilepic.svg" style="max-width:50px; width: 30px;"> </a>
                        </li>
                    </div>
                </ul>
            </div>
        </div>
    </nav>


    <div class="container-fluid mt-30">
        <div class="w-full d-flex justify-content-between">

            <div class="home-pages bg-white position-sticky rad-10">
                <ul class="fs-rem-14 d-flex flex-column w-full h-full ">
                    <li class="mb-30 mt-20 w-full p-10 rad-20">
                        <a href="profile.html"><img src="../imgs/profilepic.svg" style="width: 35px;" id="userphoto"><span class="txt-c ml-5 nameofapge" id="username"> Fouad Mohamed </span></a>
                    </li>
                    <li class="mb-30 nav-bg w-full  p-10  home-bg">
                        <div class="dropdown">
                            <button class="btn  dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                               <img src="../imgs/findperson.svg"  style="width: 43px;"> <span class="nameofapge" id="findpatient">Find patient</span>
                            </button>
                            <ul class="dropdown-menu dropbutton-bg" aria-labelledby="dropdownMenuButton1">
                                <li><a class="dropdown-item" href="#" id="findpatientselect1">Action</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="#" id="findpatientselect2">Another action</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="#" id="findpatientselect3">Something else </a></li>
                            </ul>
                        </div>
                    </li>

                </ul>

            </div>

            <div class="home-content ">

                <div class="w-full p-px-5 addcase rad-10 nav-bg d-flex justify-content-around">
                    <div class="statephoto ml-10 mt-px-5 d-none d-sm-block">
                        <img src="../imgs/profilepic.svg" style="max-height: 50px; height: 48px;">
                    </div>
                    <div class="inputstate w-80 ">
                        <input type="text" disabled class="w-full rad-10 bg-white" placeholder="Click anywhere to add case">
                    </div>

                </div>


                <div class="home-posts mt-25">


                    <!-- the main one  -->

                </div>
            </div>

            <div class="home-chats bg-white rad-10">
                <div class="chat-content d-flex flex-column w-100 p-10">
                    <div class="chat-header d-flex justify-content-between">
                        <div>
                            <span class="fw-bold fs-rem-20">Chats</span>
                        </div>
                        <div>
                            <i class="fa-solid fa-magnifying-glass fs-rem-20 cur-point"></i>
                        </div>
                    </div>
                    <div class="chat-users mt-20 w-full d-flex">
                        <ul class="overflow-auto w-full">
                            <li class="cur-point mb-20 p-px-5">
                                <img src="../imgs/profilepic.svg" alt="" style="max-width: 30px; max-height:30px;" class="user-photo mr-px-5 d-none d-lg-inline"> <span class="chat-user fw-bold">Fouad Mohamed</span>
                            </li>
                            <li class="cur-point mb-20 p-px-5">
                                <img src="../imgs/profilepic.svg" alt="" style="max-width: 30px; max-height:30px;" class="user-photo mr-px-5 d-none d-lg-inline"> <span class="chat-user fw-bold">Ali Essam</span>
                            </li>
                            <li class="cur-point mb-20 p-px-5">
                                <img src="../imgs/profilepic.svg" alt="" style="max-width: 30px; max-height:30px;" class="user-photo mr-px-5 d-none d-lg-inline"> <span class="chat-user fw-bold">Mostafa No3man</span>
                            </li>
                            <li class="cur-point mb-20 p-px-5">
                                <img src="../imgs/profilepic.svg" alt="" style="max-width: 30px; max-height:30px;" class="user-photo mr-px-5 d-none d-lg-inline"> <span class="chat-user fw-bold">Ali Elgohary</span>
                            </li>
                            <li class="cur-point mb-20 p-px-5">
                                <img src="../imgs/profilepic.svg" alt="" style="max-width: 30px; max-height:30px;" class="user-photo mr-px-5 d-none d-lg-inline"> <span class="chat-user fw-bold">Ahmed Samir</span>
                            </li>
                            <li class="cur-point mb-20 p-px-5">
                                <img src="../imgs/profilepic.svg" alt="" style="max-width: 30px; max-height:30px;" class="user-photo mr-px-5 d-none d-lg-inline"> <span class="chat-user fw-bold">Ahmed Fathlla</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>



        </div>

    </div>













    <div class="nav-bg d-none notification-content rad-10 " style="width: 350px; height: 450px; ">
        <p class="fs-25 fw-bold p-10 mb-20 ">Notifications</p>
        <ul class="w-full">
            <li style="max-height: 93px;" class="w-full ">
                <div class="notification-div w-full d-flex justify-content-start p-10">
                    <div class="d-flex justify-content-start align-items-start">
                        <img src="../imgs/notifacations/notifaction-comment.svg" alt="" class="mr-px-5">
                        <div class="d-flex flex-column w-70">
                            <span class="notifaction-user fw-bold">Fouad Mohame</span>
                            <div>
                                <span class="notification-discribtion c-grey fs-13">Lorem ipsum dolor sit amet consectetur adipisicing</span> <span class="notification-time c-grey fs-13">.3h</span>
                            </div>
                        </div>
                    </div>
                    <div class="seen-or-not ">

                    </div>

                </div>

            </li>

            <li style="max-height: 93px;" class="w-full ">
                <div class="notification-div w-full d-flex justify-content-start p-10">
                    <div class="d-flex justify-content-start align-items-start">
                        <img src="../imgs/notifacations/notifaction-like.svg" alt="" class="mr-px-5">
                        <div class="d-flex flex-column w-70">
                            <span class="notifaction-user fw-bold">Fouad Mohame</span>
                            <div>
                                <span class="notification-discribtion c-grey fs-13">Lorem ipsum dolor sit amet consectetur adipisicing</span> <span class="notification-time c-grey fs-13">.3h</span>
                            </div>
                        </div>
                    </div>
                    <div class="seen-or-not ">

                    </div>

                </div>

            </li>


            <li style="max-height: 93px;" class="w-full ">
                <div class="notification-div w-full d-flex justify-content-start p-10">
                    <div class="d-flex justify-content-start align-items-start">
                        <img src="../imgs/notifacations/notifaction-verfiey.svg" alt="" class="mr-px-5">
                        <div class="d-flex flex-column w-70">
                            <span class="notifaction-user fw-bold">Fouad Mohame</span>
                            <div class="discription-content">
                                <span class="notification-discribtion c-grey fs-13">Lorem ipsum dolor sit amet consectetur adipisicing</span> <span class="notification-time c-grey fs-13">.3h</span>
                            </div>
                        </div>
                    </div>
                    <div class="seen-or-not d-none">

                    </div>

                </div>

            </li>



            <li style="max-height: 93px;" class="w-full ">
                <div class="notification-div w-full d-flex justify-content-start p-10">
                    <div class="d-flex justify-content-start align-items-start">
                        <img src="../imgs/notifacations/notifaction-key.svg" alt="" class="mr-px-5">
                        <div class="d-flex flex-column w-70">
                            <span class="notifaction-user fw-bold">Fouad Mohame</span>
                            <div>
                                <span class="notification-discribtion c-grey fs-13">Lorem ipsum dolor sit amet consectetur adipisicing</span> <span class="notification-time c-grey fs-13">.3h</span>
                            </div>
                        </div>
                    </div>
                    <div class="seen-or-not d-none">

                    </div>

                </div>

            </li>





        </ul>

    </div>






    <!-- Button trigger modal -->
    <button type="button" class="btn btn-primary  modal2-button d-none" data-bs-toggle="modal" data-bs-target="#exampleModal">
  Launch demo modal
</button>

    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content dropbutton-bg ">
                <div class="modal-header">

                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="modalbody ">


                        <div class="Requestapatient d-block">
                            <div class="sendcase w-full d-flex justify-content-center mt-30">
                                <form class="bg-white w-80 d-flex flex-column p-30 mb-60">
                                    <div class="img-of-case">
                                        <img src="../imgs/addcase.svg" alt="" style="width: 40px;"><span id="addcase" class="fw-bold fs-15 ml-10">Add Case</span>
                                    </div>


                                    <div class="d-flex justify-content-center mt-80">
                                        <div class="mb-3 w-90 Casetitle">
                                            <label for="formGroupExampleInput" class="form-label fw-bold fs-20">Title*</label>
                                            <input type="text" class="form-control casetitle " required id="formGroupExampleInput" placeholder="Enter title">
                                        </div>
                                    </div>
                                    <span class="titleerror c-red fs-14 ml-20"> </span>
                                    <div class="w-90 d-flex justify-content-between align-center">
                                        <div class="w-40 mt-30 p-20 casetype loction">
                                            <p class="fw-bold fs-15">Location*</p>
                                            <input required list="locations" placeholder="Search for location" id="location" name="location" class="w-full p-10 form-control ">
                                            <datalist id="locations">
                                                    <option value="location1">location1</option>
                                                    <option value="location2">location2</option>
                                                    <option value="location3">location3</option>
                                                </datalist>

                                        </div>

                                        <div class="w-40 mt-30 p-20 casetype">
                                            <p class="fw-bold fs-15 ">Case type*</p>
                                            <input required list="casetypes" placeholder="Search for type" id="casetype" name="casetype" class="w-full p-10 form-control ">
                                            <datalist id="casetypes">
                                                    <option value="case1">case1</option>
                                                    <option value="case2">case2</option>
                                                    <option value="case3">case3</option>
                                                </datalist>

                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-evenly">
                                        <span class="casetypeerror c-red fs-14 ml-20"> </span>
                                        <span class="locationerror c-red fs-14 ml-20"> </span>
                                    </div>

                                    <div class="discriptioncase w-full mt-30 d-flex justify-content-center">
                                        <div class="mb-3 w-90">
                                            <label for="exampleFormControlTextarea1" class="form-label fw-bold fs-20">Description*</label>
                                            <textarea required placeholder="Enter description" class="form-control " id="exampleFormControlTextarea1" rows="5"></textarea>
                                        </div>
                                    </div>

                                    <div class=" w-full mt-30 d-flex justify-content-center mb-60 cur-point ">
                                        <div class="w-90 ">
                                            <label for="exampleFormControlTextarea1" class="form-label fw-bold fs-20">Add photo / videos <span class="c-grey fs-15">(optional)</span></label>
                                            <div class="caseimages image-preview w-full rad-10 d-flex justify-content-center align-center " style="height: 200px;">
                                                <div class=" d-flex  flex-column justify-content-center align-center selectcaseimages">
                                                    <img src="../imgs/uploadimage.svg " style="width: 30px;">
                                                    <span>Click here to add or to readd</span>
                                                </div>
                                            </div>
                                            <p class="c-grey fs-14 mt-10">(hint: you can't delete choossen image if you want to delete, chosoe from first again)</p>
                                        </div>

                                    </div>

                                    <div class="modal-footer w-full d-flex justify-content-evenly">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                        <input type="submit" value="Add" class="btn btn-primary sendcasebutton">
                                        <input type="file" class="selectcaseimage d-none" multiple onchange="displayImages(this)">
                                    </div>
                                </form>
                            </div>
                        </div>


                    </div>
                </div>

            </div>
        </div>
    </div>










    <script src="../js/bootstrap.bundle.min.js "></script>
    <script src="../js/all.min.js "></script>
    <script src="../js/popper.min.js "></script>
    <script src="../js/helper.js "></script>
    <script src="../js/jquery-3.6.1.min.js "></script>


    <script>
        $(".search").keypress(function(event) {
            if ((event.key).toLowerCase() == "enter") {
                window.location.href = "search.html";
            }
        })

        $('.search-icon').on('click', function() {
            window.location.href = "search.html";
        });
    </script>









    <!-- thisssssssssssssssssssss -->
    <!-- share page for social media  -->



    <script>
        $("a.nav-link").click(function(e) {
            e.preventDefault();
        })

        $(".notificationmark").click(function() {
            $(".notification-content ").toggleClass("d-none");
        })

        $(".addcase").click(function() {
            $(".modal2-button").trigger("click");
        })

        $(".selectcaseimages").click(function() {
            $(".selectcaseimage").trigger("click");
        })

        $(".selectcaseimages2").click(function() {
            $(".selectcaseimage2").trigger("click");
        })

        var locationDisplay = false;

        $('input[name="case"]').change(function() {
            if ($('input[name="case"]:checked').val() == "requestapatient") {
                $(".Requestapatient").css('display', 'block');
                $(".loction").css('display', 'none');
                $(".img-of-case img").attr("src", "../imgs/addcase.svg");
                $(".img-of-case span").text("Add Case")
                $("#location").removeAttr("required");
                locationDisplay = false;
            } else {
                $(".Requestapatient").css('display', 'block');
                $(".loction").css('display', 'block');
                $(".img-of-case img").attr("src", "../imgs/sharecase.svg");
                $(".img-of-case span").text("Share Case")
                $("#location").attr("required", "true");
                locationDisplay = true;
            }
        })

        $(".moreimg").click(function() {
            $(this).toggleClass("rotate-90");
            $(this).next("ul").toggleClass("d-none");

        })

        $(".share-links").click(function() {
            $(".sharemodal").trigger("click");
        })
        $(".block").click(function() {
            $(".blockmodal").trigger("click");
        })

        $(".report").click(function() {
            $(".reportmodal").trigger("click");
        })

        $("#share-link").val(window.location.href)
    </script>


    <!-- check if the value exisr in options or not -->
    <script>
        // Get the input field and the datalist
        var inputField = document.getElementById("casetype");
        var datalist = document.getElementById("casetypes");
        var locationField = document.getElementById("location");
        var locationDatalist = document.getElementById("locations");

        // Listen for form submission
        var sendcasebutton = document.querySelector('.sendcasebutton');
        sendcasebutton.addEventListener('click', function(event) {
            // Get the selected option from the datalist
            var optionSelected = false;
            for (var i = 0; i < datalist.options.length; i++) {
                if (inputField.value == datalist.options[i].value) {
                    optionSelected = true;
                    break;
                }
            }

            var optionSelected2 = false;
            for (var i = 0; i < locationDatalist.options.length; i++) {
                if (locationField.value == locationDatalist.options[i].value) {
                    optionSelected2 = true;
                    break;
                }
            }


            // If the selected option is not in the datalist, prevent form submission
            if (!optionSelected) {
                event.preventDefault();
                $(".casetypeerror").text(" Please select a valid case type.");
                $(".casetypeerror").css("display", "block");

            } else {
                $(".casetypeerror").text("");
                $(".casetypeerror").css("display", "none");
            }

            if (!optionSelected2 && locationDisplay) {
                event.preventDefault();
                $(".locationerror").text(" Please select a valid location.");
                $(".locationerror").css("display", "block");

            } else {
                $(".locationerror").text("");
                $(".locationerror").css("display", "none");
            }
        });
    </script>

    <!-- thisssssssssssssssssssss -->
    <!-- display selected images in container -->
    <script>
        function displayImages(input) {
            if (input.files && input.files.length > 0) {
                var previewContainer = document.querySelector('.image-preview');

                var imagesToDelete = [];

                for (var i = 0; i < input.files.length; i++) {
                    var reader = new FileReader();
                    reader.onload = function(e) {
                        var image = new Image();
                        var deleteMark = document.createElement('div');
                        deleteMark.innerHTML = 'x';
                        deleteMark.style.position = "absolute";
                        deleteMark.style.left = "2px";
                        deleteMark.style.top = "0px";
                        deleteMark.classList.add('delete-mark');
                        var imageWrapper = document.createElement('div');
                        imageWrapper.style.position = "relative";
                        $(imageWrapper).addClass("mr-px-5")
                        imageWrapper.classList.add('image-wrapper');
                        imageWrapper.appendChild(image);
                        imageWrapper.appendChild(deleteMark);
                        image.src = e.target.result;
                        $(imageWrapper).css('max-width', '80px');
                        $(imageWrapper).css('max-height', '90%');
                        $(image).css('max-width', '100%');
                        $(image).css('max-height', '100%');
                        previewContainer.prepend(imageWrapper);

                        console.log('Input files:', input.files); // log input files to console
                        deleteMark.onclick = function() {
                            imagesToDelete.push(imageWrapper);
                            imageWrapper.remove();
                            var index = Array.from(previewContainer.children).indexOf(imageWrapper);
                            if (index !== -1) {
                                $(input).val(Array.from(input.files).filter(function(file, i) {
                                    return i !== index;
                                }));
                            }
                            console.log('Input files:', input.files); // log input files to console
                        }
                    }
                    reader.readAsDataURL(input.files[i]);
                }
            }
        }
    </script>

    <!-- make see more sacebook effect -->
    <script>
        const showMoreLinks = document.querySelectorAll('.seemore');

        const maxChars = 150;

        showMoreLinks.forEach(link => {
            const postText = link.closest('.post-text');
            const postDescription = postText.querySelector('.post-description');
            const descriptionText = postDescription.textContent.trim();
            const truncatedText = descriptionText.substring(0, maxChars).trim() + '...';

            if (descriptionText.length <= maxChars) {
                link.style.display = 'none';
            } else {
                postDescription.textContent = truncatedText;
            }

            link.addEventListener('click', (event) => {
                event.preventDefault();
                if (postDescription.textContent === truncatedText) {
                    postDescription.textContent = descriptionText;
                    link.textContent = 'Show less';
                } else {
                    postDescription.textContent = truncatedText;
                    link.textContent = 'See more';
                }
            });
        });
    </script>

    <!-- enable tooltip of bootstrap -->
    <script>
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        var tooltipList = tooltipTriggerList.map(function(tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl)
        })
    </script>


    <!-- API requesta -->
    <script>
        (async() => {
            let apiUrl = await GetServerDomain();;
            let language;
            if (window.localStorage.getItem("language") == null) {
                language = "en";
            } else {
                language = window.localStorage.getItem("language");
            }


            // check if theuser is loged in or not 
            $.ajax({
                "method": "GET",
                "url": apiUrl + "/api/Users/IsAllowedToHome",
                "xhrFields": {
                    "withCredentials": true
                },
                "headers": {
                    "Content-Type": "application/json",
                    "ngrok-skip-browser-warning": "69420",
                    "Accept-Language": language
                },
                "data": {},
                success: function(data, st, xhr) {
                    console.log(data)
                    if (data.nextPage == "homePatient") {
                        console.log("hello patient");
                    } else if (data.nextPage == "homeDentist") {
                        window.location.href = "dentist/home.html";
                    } else if (data.nextPage == "homeAdmin") {
                        window.location.href = "../dashboard.html";
                    }
                },
                error: function(xhr, status, err) {
                    console.log(xhr);
                    window.location.href = "../login.html";
                }
            })





            $.ajax({
                "method": "GET",
                "url": apiUrl + "/api/patients/GetDentistsCases?Page=1&Size=8",
                "xhrFields": {
                    "withCredentials": true
                },
                "headers": {
                    "Content-Type": "application/json",
                    "ngrok-skip-browser-warning": "69420",
                    "Accept-Language": language
                },
                "data": {},
                success: function(data, st, xhr) {
                    console.log(data);

                    for (var counter = 0; counter < data.length; counter++) {

                        $(".home-posts").append(`<div class="home-post" id="${data[counter].postId}">
                        <div class="mb-30 post-body d-flex flex-column p-30 bg-white  rad-10">
                            <div class="post-head d-flex justify-content-between">
                                <div class="post-user-info d-flex flex-row">
                                    <div class="user-image rad-half mr-10">
                                        <img src="../imgs/profilepic.svg" class = "profile${data[counter].postId}" alt="" style="max-width: 100%;">
                                    </div>
                                    <div class="post-info d-flex flex-column">
                                        <div class="d-flex usernames align-center">
                                            <span class="fs-rem-14 fw-bold name">${data[counter].userInfo.fullName}</span><span class="username fs-rem-12 c-grey">@${data[counter].userInfo.username}</span></div>
                                        <span class="user-case fw-bold c-blue fs-rem-12">${data[counter].dentistInfo.academicDegree}</span>
                                        <span class="user-mohafza c-grey fs-rem-10">${data[counter].governorate}</span>
                                        <div>
                                            <span class="post-time c-grey fs-rem-10 mr-px-5">${data[counter].timeWritten}</span><span class="fs-rem-10 c-grey mr-px-5 edited">Edited at</span><span class="editedtime${data[counter].postId} edited fs-rem-10 c-grey">8</span></div>
                                        <div class="casetype-bg p-1 txt-c w-fit case-type-rad"><span class="case-type c-white casetype-bg fs-rem-11  overflow-hidden" title = "${data[counter].caseType}" >${data[counter].caseType}</span></div>
                                    </div>
                                </div>
                                <div class="more-about-post d-flex flex-column align-center">
                                    <img src="../imgs/more.svg" class="moreimg cur-point" style="width: 30px; max-width: 35px;">
                                    <ul class="p-10 dropbutton-bg mt-px-5 d-none">
                                        <li class="p-10 share-links${data[counter].postId} share-links">Share via</li>
                                        <!-- share moadale -->

                                        <!-- Button trigger modal -->
                                        <button type="button" class="btn btn-primary d-none sharemodal " data-bs-toggle="modal" data-bs-target="#exampleModal${data[counter].postId}">
                                                Launch demo modal
                                        </button>

                                        <!-- Modal -->
                                        <div class="modal fade" id="exampleModal${data[counter].postId}" tabindex="-1" aria-labelledby="exampleModalLabel${data[counter].postId}" aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-centered">
                                                <div class="modal-content sharemodal-bg">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title c-white" id="exampleModalLabel${data[counter].postId}">Share</h5>
                                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <div class="social-media-icons row flex-row p-20">
                                                            <div class="col-6 col-md-3 p-0 p-1 cur-point share-icon post1" style="width: fit-content;">
                                                                <a class="whatsapp${data[counter].postId}" target="_blank"> <img src="../imgs/what's-share.svg" alt="" style="max-width: 100%;"></a>
                                                            </div>
                                                            <div class="col-6 col-md-3 p-0 p-1 cur-point  share-icon" style="width: fit-content;">
                                                                <a class="facebook-share${data[counter].postId}" target="_blank"> <img src="../imgs/facebook-share.svg" alt="" style="max-width: 100%;"></a>
                                                            </div>
                                                            <div class="col-6 col-md-3 p-0 p-1 cur-point  share-icon" style="width: fit-content;">
                                                                <a class="twitter-share${data[counter].postId}" target="_blank" > <img src="../imgs/twitter-share.svg" alt="" style="max-width: 100%;"></a>
                                                            </div>
                                                        </div>

                                                        <div class="social-link${data[counter].postId} social-link cur-point mt-20 w-100 p-px-5 d-flex align-center justify-content-between">

                                                            <input class="overflow-hidden cur-point w-80 copied-link " readonly id="share-link${data[counter].postId}">


                                                            <span class="copy cur-point">Copy</span>

                                                        </div>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>

                                        <li class="p-10 report">report</li>

                                        <!-- report moadale -->

                                        <!-- Button trigger modal -->
                                        <button type="button" class="btn btn-primary d-none reportmodal" data-bs-toggle="modal" data-bs-target="#exampleModal100${data[counter].postId}">
                                            Launch demo modal
                                        </button>

                                        <!-- Modal -->
                                        <div class="modal fade" id="exampleModal100${data[counter].postId}" tabindex="-1" aria-labelledby="exampleModalLabel100${data[counter].postId}" aria-hidden="true">
                                            <div class="modal-dialog modal-lg">
                                                <div class="modal-content rad-20 d-flex justify-content-center align-center p-50 reportmodal-bg">

                                                    <div class="modal-body reportmodaldiv w-70 case-bg">
                                                        <div class="d-flex ">
                                                            <p>Report <span class="reporteduser c-grey">@${data[counter].userInfo.username}’s post</span></p>
                                                        </div>
                                                        <div>
                                                            <form>


                                                                <div class="mb-3 w-100">

                                                                    <textarea  placeholder="The reason of report" class="form-control reportarea${data[counter].postId}" id="exampleFormControlTextarea2${data[counter].postId}" rows="10"></textarea>

                                                                </div>

                                                                <div class="modal-footer d-flex justify-content-evenly">
                                                                    <input type="submit" class="btn btn-primary reportbuton${data[counter].postId} rad-25 p-30 shadow">
                                                                    <button type="button" class="btn btn-secondary rad-25 reportbutoncancel${data[counter].postId} shadow" data-bs-dismiss="modal">Cancel</button>
                                                                </div>
                                                                <div class = "mt-30">
                                                                <span class="reporterror${data[counter].postId} reporterror txt-c  fs-rem-14"></span>    
                                                                </div>

                                                                
                                                            </form>
                                                        </div>


                                                    </div>

                                                </div>
                                            </div>
                                        </div>

                                        <li class="p-10 block  lastli">block</li>
                                        <!-- block moadale -->

                                        <!-- Button trigger modal -->
                                        <button type="button" class="btn btn-primary d-none blockmodal" data-bs-toggle="modal" data-bs-target="#exampleModal1000${data[counter].postId}">
                                            Launch demo modal
                                        </button>

                                        <!-- Modal -->
                                        <div class="modal fade" id="exampleModal1000${data[counter].postId}" tabindex="-1" aria-labelledby="exampleModalLabel1000${data[counter].postId}" aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-centered blockmodaldiv">
                                                <div class="modal-content rad-20">

                                                    <div class="modal-body">
                                                        <p class="fw-bold txt-c">Are you sure you want to block<span class="c-grey blockedusername">@${data[counter].userInfo.username}</span> ?</p>
                                                    </div>
                                                    <div class="modal-footer d-flex justify-content-evenly">
                                                        <button type="button" class="btn btn-primary blockbutton${data[counter].postId} blockbutton  rad-25 p-30 shadow">Yes</button>
                                                        <button type="button" class="btn btn-secondary rad-25 blockbuttoncancel${data[counter].postId} blockbuttoncancel shadow" data-bs-dismiss="modal">No</button>

                                                    </div>
                                                    <div class = "mt-30 mb-20">
                                                    <span class = "blockerror${data[counter].postId} blockerror c-red txt-c fs-rem-14">Something went wrong , please try again later</span>    
                                                    </div>
                                                </div>
                                            </div>
                                        </div>


                                    </ul>
                                </div>
                            </div>
                            <div class="post-text">
                                <h3 class="post-title">${data[counter].title}</h3>
                                <p class="m-0 d-inline post-description">${data[counter].body}</p><span class="cur-point seemore">... See more</span>
                            </div>
                            <div class="post-images post-images${data[counter].postId}">
                                <div class="images${data[counter].postId} d-flex w-100 mt-40 justify-content-center">
                                  

                                </div>

                            </div>
                            <div class="post-call mt-40">
                                <div class="w-full d-flex justify-content-between align-center">
                                    <div class="call call${data[counter].postId}">
                                        <button type="button" class="btn btn-secondary button-bg " data-bs-toggle="tooltip" data-bs-placement="top" title="01016218389">
                                           <i class="fa-solid fa-phone-volume hvr-buzz mr-px-5"></i> <span>Call</span>
                                        </button>
                                    </div>
                                    <div class="chat">
                                        <button type="button" class="btn btn-secondary button-bg " data-bs-placement="top">
                                           <i class="fa-regular fa-comment mr-px-5"></i> <span>Chat</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>`)


                        // check if there is phone or not 
                        if (data.phone == null) {
                            $(`.call${data[counter].postId} button`).attr('disabled', 'disabled');
                        } else {
                            $(`.call${data[counter].postId} button`).attr('title', data.phone);
                        }

                        // check if Post is edited or not
                        if (data[counter].timeUpdated == null) {
                            $(".edited").css("display", "none");
                        } else {
                            $(`editedtime${data[counter].postId}`).text(data[counter].timeUpdated)
                        }

                        // check if user have profile pic or not
                        if (data[counter].userInfo.profilePicture == null) {} else {
                            $(`.profile${data[counter].postId}`).attr("src", `data:image/png;base64${data[counter].userInfo.profilePicture}`);
                        }

                        //check if user have images and display it
                        if (data[counter].images == null || data[counter].length == 0) {
                            $(`.images${data[counter].postId}`).css("display", "none");
                        } else {
                            for (var i = 0; i < data[counter].images.length; i++) {
                                console.log(i)
                                $(`.images${data[counter].postId}`).append(`<div class="image h-75 mr-15" style="width:200px; height:200px">
                                                                    <img src="data:image/png;base64,${data[counter].images[i]}" alt="" style="max-width:100%; max-height:100%;width:200px; height:200px">
                                                                    </div>`)
                            }
                        }





                        // in the loop 
                        // Get the "Copy" element and the share link element
                        const copyLink = document.querySelector(`.social-link${data[counter].postId}`);
                        const shareLink = document.querySelector(`#share-link${data[counter].postId}`);

                        // Add click event listener to the "Copy" element
                        copyLink.addEventListener('click', () => {
                            // Create a temporary input element to hold the share link text
                            shareLink.select();
                            document.execCommand("copy");
                            shareLink.blur();
                        });





                        $(`#share-link${data[counter].postId}`).val(window.location.href)


                        const link = encodeURI(window.location.href);
                        const msg = encodeURIComponent('Hey, I found this article');
                        const title = encodeURIComponent('Article or Post Title Here');

                        const fb = document.querySelector(`.facebook-share${data[counter].postId}`);
                        fb.href = `https://www.facebook.com/share.php?u=${link}`;

                        const twitter = document.querySelector(`.twitter-share${data[counter].postId}`);
                        twitter.href = `http://twitter.com/share?&url=${link}&text=${msg}&hashtags=javascript,programming`;

                        const whatsapp = document.querySelector(`.whatsapp${data[counter].postId}`);
                        whatsapp.href = `https://api.whatsapp.com/send?text=${msg}: ${link}`;


                        //request of report button
                        $(`.reportbuton${data[counter].postId}`).click(function(e) {
                            e.preventDefault();
                            postId = data[counter].postId;
                            reason = $(`.reportarea${data[counter].postId}`).val();

                            let reportObj = {
                                "reported_post_id": postId,
                                "reason": reason
                            }

                            let jsonData = JSON.stringify(reportObj);

                            if (reason.length == 0 || reason == null) {
                                delete reportObj.reason
                            }
                            $.ajax({
                                "method": "POST",
                                "url": apiUrl + "/api/Common/ReportPost",
                                "xhrFields": {
                                    "withCredentials": true
                                },
                                "headers": {
                                    "Content-Type": "application/json",
                                    "ngrok-skip-browser-warning": "69420",
                                    "Accept-Language": language
                                },
                                "data": jsonData,

                                success: function(data, st, xhr) {
                                    console.log(data);
                                    $(`.reporterror${data[counter].postId}`).text("Report sent successfully");
                                    $(`.reporterror${data[counter].postId}`).css('color', 'green');
                                    $(`.reporterror${data[counter].postId}`).css('display', 'block');
                                    setTimeout(function() {
                                        $(`.reportbutoncancel${data[counter].postId}`).trigger('click');
                                    }, 2000)


                                },
                                error: function(xhr, status, err) {
                                    $(`.reporterror${data[counter].postId}`).text(xhr.responseJSON.error);
                                    $(`.reporterror${data[counter].postId}`).css('color', 'red');
                                    $(`.reporterror${data[counter].postId}`).css('display', 'block');

                                    setTimeout(function() {
                                        $(`.reportbutoncancel${data[counter].postId}`).trigger('click');
                                    }, 2000)

                                }
                            })
                        });

                        //request of block button
                        $(`.blockbutton${data[counter].postId}`).click(function(e) {
                            e.preventDefault();
                            userId = data[counter].userInfo.userId;
                            let blockObj = {
                                "blocked_user_id": userId
                            }
                            let jsonData = JSON.stringify(blockObj);

                            $.ajax({
                                "method": "POST",
                                "url": apiUrl + "/api/Common/BlockUser?blocked_user_id=" + userId,
                                "xhrFields": {
                                    "withCredentials": true
                                },
                                "headers": {
                                    "Content-Type": "application/json",
                                    "ngrok-skip-browser-warning": "69420",
                                    "Accept-Language": language
                                },


                                success: function(data, st, xhr) {
                                    console.log(data);
                                    $(`.blockerror${data[counter].postId}`).css('display', 'none');
                                    $(`.blockbuttoncancel${data[counter].postId}`).trigger('click');



                                },
                                error: function(xhr, status, err) {
                                    if (xhr.status == 400) {

                                        $(`.blockerror${data[counter].postId}`).text(xhr.responseJSON.error);
                                        $(`.blockerror${data[counter].postId}`).css('display', 'block');
                                    } else {
                                        $(`.blockerror${data[counter].postId}`).text("Something went wrong, please try again");
                                        $(`.blockerror${data[counter].postId}`).css('display', 'block');
                                    }


                                }
                            })

                        });

                    }
                    // end of for loop



                    //enable tolltip of bootstrap
                    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
                    var tooltipList = tooltipTriggerList.map(function(tooltipTriggerEl) {
                        return new bootstrap.Tooltip(tooltipTriggerEl)
                    })

                    //   facebook seemore effect 
                    const showMoreLinks = document.querySelectorAll('.seemore');
                    const maxChars = 150;
                    showMoreLinks.forEach(link => {
                        const postText = link.closest('.post-text');
                        const postDescription = postText.querySelector('.post-description');
                        const descriptionText = postDescription.textContent.trim();
                        const truncatedText = descriptionText.substring(0, maxChars).trim() + '...';
                        if (descriptionText.length <= maxChars) {
                            link.style.display = 'none';
                        } else {
                            postDescription.textContent = truncatedText;
                        }
                        link.addEventListener('click', (event) => {
                            event.preventDefault();
                            if (postDescription.textContent === truncatedText) {
                                postDescription.textContent = descriptionText;
                                link.textContent = 'Show less';
                            } else {
                                postDescription.textContent = truncatedText;
                                link.textContent = 'See more';
                            }
                        });
                    });

                    $(".moreimg").click(function() {
                        $(this).toggleClass("rotate-90");
                        $(this).next("ul").toggleClass("d-none");
                    })

                    $(`.share-links`).click(function() {
                        $(this).next(`button`).trigger("click");
                    })

                    $(`.block`).click(function() {
                        $(this).next(`button`).trigger("click");
                    })

                    $(`.report`).click(function() {
                        $(this).next(`button`).trigger("click");
                    })


                },
                error: function(xhr, status, err) {
                    console.log(xhr);
                }
            })





        })();
    </script>



</body>

</html>