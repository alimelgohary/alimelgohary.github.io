<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;500&#038;display=swap" rel="stylesheet" />

    <link rel="stylesheet" href="../css/Normalize.css">
    <link rel="stylesheet" href="../css/imagehover.min.css">
    <link rel="stylesheet" href="../css/imagehover.css">
    <link rel="stylesheet" href="../css/all.min.css" />
    <link rel="stylesheet" href="../css/framework.css">
    <link rel="stylesheet" href="../css/master.css">
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/animate.min.css">
    <link rel="stylesheet" href="../css/hover.css">
    <link rel="stylesheet" href="../css/signup.css">
    <title>Free Smile</title>
    <link rel="icon" type=" image/svg+xml" href="../imgs/logo.svg" />
</head>

<body>




    <div class="logo d-flex mt-30 mb-40 justify-content-center align-center">
        <img src="../imgs/logo.svg" />

    </div>

    <div class="txt-c  mb-30">
        <h3 class="fw-bold">At Least We Want To Verify Your Academic Degree </h3>
        <p class="fs-5 c-grey">( Rest assured as this information is deleted after varification )</p>

    </div>

    <div class="w-full babyblue-background-color docverfy mb-40">
        <div class="container p-10">
            <form method="post">
                <div class=" row  ">
                    <div class="col-6">
                        <div>
                            <p class=" fw-bold mt-20 ca">Academic Degree*</p>

                            <select class="form-select fs-4 p-10 mb-10 col-6 rad-10 babyblue-background-color2 " id="acadimic-deg" aria-label="Default select example" required name="academicDegree">
                                <option selected value="1">Undergradute</option>
                                <option value="2">Graduated </option>
                            
                            </select>
                        </div>
                        <div>
                            <p class=" fw-bold mt-20 ca">Current University*</p>

                            <select class="form-select fs-4 p-10 mb-10 col-6 rad-10 babyblue-background-color2 " id="CurrentUni" aria-label="Default select example" name="academicDegree">
                               
                            
                            </select>
                        </div>

                        <div class="mt-35 idphoto">

                            <p class=" fw-bold mt-20">National ID Photo <span class="c-grey fs-13">( Face )</span>*</p>
                            <input accept="image/*" required type="file" name="file[]" id="nationalphoto" class="idphoto d-none">
                            <div class="d-flex align-center justify-content-between">
                                <p class="mt-20 txt-c rad-10  p-10  fidphoto" style="display: inline-block;background-color: #71C9CE; cursor: pointer;"> Upload Photo</p>
                                <span class="c-red fs-15 idphotoerror ">error message </span>
                            </div>
                        </div>


                        <div class="mt-35 idphoto2">
                            <p class=" fw-bold mt-20">University ID photo or your degree certificate <span class="c-grey fs-13">( Face )</span>*</p>

                            <input accept="image/*" required type="file" name="file[]" id="universityid" class="idphoto2 d-none">
                            <div class="d-flex align-center justify-content-between">
                                <p class="mt-20 txt-c rad-10 p-10 babyblue-background-color2 fidphoto2" style="background-color: #71C9CE; cursor: pointer;"> Upload Photo</p>
                                <span class="c-red fs-15 universityiderror ">error message </span>
                            </div>
                        </div>
                    </div>

                    <div class="col-6 d-flex justify-content-center">
                        <img src="../imgs/docverfy.svg" alt="Verify image" style="width: 200px;">
                    </div>
                </div>

                <div class="d-flex justify-content-center">
                    <button type="submit" class="btn  w-50 rad-10" style="background-color: #71C9CE;">Submit</button>

                </div>

            </form>

        </div>
    </div>






    <script src="../js/bootstrap.bundle.min.js "></script>
    <script src="../js/all.min.js "></script>
    <script src="../js/popper.min.js "></script>
    <script src="../js/jquery-3.6.1.min.js "></script>
    <script src="../js/helper.js"></script>



    <script>
        (async() => {

            let apiUrl = await GetServerDomain();
            let errorMessages;

            let language = window.localStorage.getItem("language")
            if (language == null) {
                language = "en";
            }



            if (!window.localStorage.getItem("resend")) {

                $.ajax({
                    "method": "GET",
                    "url": apiUrl + "/api/Generic/GetUniversities",

                    "headers": {
                        "Content-Type": "application/json",
                        "ngrok-skip-browser-warning": "69420",
                        "Accept-Language": language
                    },

                    success: function(data, st, xhr) {
                        window.localStorage.setItem("resend", "value");

                        for (let i = 0; i < data.length; i++) {
                            let selectElem = document.querySelector("#CurrentUni");
                            selectElem.innerHTML += ("<option value=" + data[i]['id'] + ">" + data[i]['name'] + "</option>");

                        }

                    },
                    error: function(xhr, status, err) {
                        let selectElem = document.querySelector("#CurrentUni");
                        selectElem.innerHTML += ("<option> Some Thing went wrong try again later </option>");



                    }
                })
            }







            $(".fidphoto").click(function() {
                $(".idphoto").trigger("click");
            })
            $(".fidphoto2").click(function() {
                $(".idphoto2").trigger("click");
            })


            //  apiUrl + "/api/Dentists/RequestVerification"
            $("form").submit(function(event) {
                event.preventDefault();
                let academicDegree = $("#acadimic-deg").val();
                let nationalId = $("#nationalphoto").prop('files')[0];
                let universityId = $("#universityid").prop('files')[0];
                let currentUni = $("#CurrentUni").val();
                const formData = new FormData();
                formData.append('universityRequested', currentUni);
                formData.append('degreeRequested', academicDegree);
                formData.append('natIdPhoto', nationalId);
                formData.append('proofOfDegreePhoto', universityId);

                $.ajax({
                    url: apiUrl + "/api/Dentists/RequestVerification",
                    method: 'POST',
                    data: formData,
                    "xhrFields": {
                        "withCredentials": true
                    },
                    "headers": {

                        "Accept-Language": language
                    },
                    contentType: false,
                    processData: false,
                    success: function(response) {
                        window.location.replace("wait.html");
                    },
                    error: function(xhr, status, error) {
                        let errorobj = xhr.responseJSON.errors
                        console.log(errorobj);
                        if (xhr.responseJSON.error == "You have already requested verification") {
                            window.location.href = "wait.html"
                        } else if (errorobj.hasOwnProperty('NatIdPhoto')) {
                            $(".idphotoerror").text(errorobj.NatIdPhoto[0]);
                            $(".idphotoerror").css('display', 'block');
                        } else if (errorobj.hasOwnProperty('ProofOfDegreePhoto')) {
                            $(".universityiderror").text(errorobj.ProofOfDegreePhoto[0]);
                            $(".universityiderror").css('display', 'block');
                        }
                    }
                });

            })







        })();
    </script>
</body>

</html>